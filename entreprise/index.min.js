var compteur=0;function ajout_competence(){var c=document.createTextNode("Nom : ");var b=document.createElement("input");var a=document.createElement("br");b.setAttribute("type","text");b.setAttribute("name","competence_ajout"+compteur);document.getElementById("ajout_competence").appendChild(c);document.getElementById("ajout_competence").appendChild(b);document.getElementById("ajout_competence").appendChild(a);compteur++}function swap_offre(){var f=document.getElementById("title");var c=document.getElementById("radioAlternance");var b=document.getElementById("divTypeContrat");var a=document.getElementById("dureeStage");var e=document.getElementById("dureeAlt");var d=document.getElementById("thSiret");if(c.checked){f.innerHTML="Offre d'alternance";a.style.display="none";e.style.display="block";b.style.display="";d.innerHTML="SIRET (*) : "}else{f.innerHTML="Offre de stage";e.style.display="none";a.style.display="block";b.style.display="none";d.innerHTML="SIRET :"}}function PopupList(b,a){this.list=document.createElement("div");document.body.appendChild(this.list);this.index=-1;this.source=b;this.setLayout();this.hide();this.setBehaviour(a)}PopupList.prototype={setLayout:function(){this.list.style.background="Window";this.list.style.border="solid 1px WindowText";this.list.style.padding="2px";this.list.style.position="absolute";this.list.style.left=Element.getLeft(this.source)+"px";this.list.style.top=(Element.getTop(this.source)+this.source.offsetHeight)+"px"},clear:function(){this.list.style.display="none";this.list.innerHTML="";this.index=-1;this.values=[]},display:function(){if(this.list.childNodes.length>0){this.list.style.display="block"}},hide:function(){this.list.style.display="none"},isVisible:function(){return this.list.style.display!="none"},setOptions:function(a){this.clear();if(a.length>0){var b;for(i=0;i<a.length;i++){b=document.createElement("div");b.innerHTML=a[i].nom+" ("+a[i].adresse+" "+a[i].codepostal+" "+a[i].ville+")";this.list.appendChild(b);b.setAttribute("index",i);b.className="option"}this.display();this.values=a}},setBehaviour:function(a){var b=this;this.list.onmouseover=function(c){var d=Event.target(c);if(d.className=="option"){b.go(d.getAttribute("index"));Event.stopPropagation(c)}};this.list.onmouseout=function(c){b.go(-1)};this.list.onclick=function(c){b.source.value=b.values[b.index].nom;if(a){a(b.values[b.index])}b.clear();b.source.focus()}},go:function(a){var b=this.list.childNodes;if(-1<this.index&&this.index<b.length){b[this.index].style.background="Window";b[this.index].style.color="WindowText"}if(-1<a&&a<b.length){this.index=a}else{if(a<=-1){this.index=-1}else{this.index=b.length-1}}if(this.index!=-1){b[this.index].style.background="Highlight";b[this.index].style.color="HighlightText"}},getValue:function(){return(0<=this.index&&this.index<this.list.childNodes.length)?this.list.childNodes[this.index].innerHTML:""},getLength:function(){return this.list.childNodes.length}};PopupList.prototype.constructor=PopupList;function Suggest(){}Suggest.prototype={init:function(b,a,c){this.source=document.getElementById(b);this.maxSuggestNumber=(c)?c:10;this.check(b);this.popup=new PopupList(this.source,a);this.inputValue="";this.setBehaviour()},check:function(a){if(this.source==null){Log.error("Element with id '"+a+"' not found")}if(isNaN(parseInt(this.maxSuggestNumber))||parseInt(this.maxSuggestNumber)<=0){Log.error("Max suggest number for '"+a+"' not positive ("+this.maxSuggestNumber+")")}},setOptions:function(){Log.error("setOptions is abstract, must be implemented")},setBehaviour:function(){this.source.setAttribute("autocomplete","off");var a=this;this.source.onkeyup=function(b){a.onkeyup(b)};this.source.onkeydown=function(b){a.onkeydown(b)};this.source.onblur=function(){if(a.popup.index==-1){a.popup.hide()}}},onkeydown:function(a){var b=Event.event(a);switch(b.keyCode){case Keys.ESCAPE:this.popup.hide();break;case Keys.ENTER:if(this.popup.isVisible()){Event.preventDefault(b);this.popup.clear()}break;case Keys.TAB:this.popup.clear();break;case Keys.DOWN:this.goAndGet(this.popup.index+1);break;case Keys.UP:this.goAndGet(this.popup.index-1);break;case Keys.PAGE_UP:this.goAndGet((this.popup.getLength()>0)?0:-1);break;case Keys.PAGE_DOWN:this.goAndGet(this.popup.getLength()-1);break;default:break}},goAndGet:function(a){this.popup.go(a);if(-1<this.popup.index){this.source.value=this.popup.getValue()}else{this.source.value=this.inputValue}},onkeyup:function(a){switch(Event.event(a).keyCode){case Keys.DOWN:case Keys.UP:case Keys.PAGE_UP:case Keys.HOME:case Keys.PAGE_DOWN:case Keys.END:case Keys.ENTER:case Keys.ESCAPE:break;default:this.inputValue=this.source.value;this.setOptions()}},};Suggest.prototype.constructor=Suggest;function HttpSuggest(c,a,b,d){this.url=a;if(this.url.indexOf("?")==-1){this.url+="?"}else{this.url+="&"}this.request=new XMLHttpRequest();Suggest.prototype.init.call(this,c,b,d)}HttpSuggest.prototype=new Suggest();HttpSuggest.prototype.setOptions=function(){try{this.request.abort()}catch(a){}try{if(this.source.value!==""){var b=this.url+"search="+encodeURIComponent(this.source.value)+"&size="+this.maxSuggestNumber;this.request.open("GET",b,true);var c=this;this.request.onreadystatechange=function(){try{if(c.request.readyState==4&&c.request.status==200){var e=JSON.parse(c.request.responseText);c.popup.setOptions(e)}}catch(d){Log.error("exception onreadystatechange")}};this.request.send(null)}else{this.popup.clear()}}catch(a){Log.error(a)}};function setEntreprise(a){document.getElementById("adresse").value=a.adresse;document.getElementById("ville").value=a.ville;document.getElementById("codepostal").value=a.codepostal;document.getElementById("pays").value=a.pays;a.email?document.getElementById("email_entreprise").value=a.email:document.getElementById("email_entreprise").value="";a.siret?document.getElementById("siret").value=a.siret:document.getElementById("siret").value=""}function auchargement(){var a=document.getElementById("radioStage");a.checked=true;swap_offre();new HttpSuggest("nom_entreprise","getEntreprisesJSON.php",setEntreprise)};